function init(){if(!initialized){initialized=!0,getCommonReferences();for(var e=document.getElementById("f"),t=0;t<e.elements.length;t++)e.elements[t].disabled=!1;animatable=isAnimatable(),enhanceCountryOptions(),ajaxify(),extendStyles(function(){enhanceSky(),enhanceWater(),enhanceImages()})}}function enhanceSky(){var e=document.getElementById("ab"),t=document.createElement("div");t.className="bwrap",e.appendChild(t),setTimeout(function(){t.style.opacity=1},50);for(var n=0;3>n;n++){var o=document.createElement("div");o.className="bird b"+(n+1),t.appendChild(o)}var r=document.createElement("div");r.className="cwrap",e.appendChild(r),setTimeout(function(){r.style.opacity=1},50);var a=document.createElement("div");a.className="ctext",a.textContent="Rawr..?",r.appendChild(a);var l=document.createElement("div");l.className="ccorner",r.appendChild(l)}function enhanceWater(){var e=document.createElement("div");e.className="awrap",ref.waterBackground.appendChild(e),setTimeout(function(){e.style.opacity=1},50);for(var t=0;4>t;t++){var n=document.createElement("div");n.className="abubble a"+(t+1),e.appendChild(n)}}function enhanceImages(){var e=document.createElement("div");e.className="icon ic1",ref.solutionContainer.appendChild(e),setTimeout(function(){e.style.opacity=.6},50);var t=document.createElement("div");t.className="icon ic2",ref.solutionContainer.appendChild(t),setTimeout(function(){t.style.opacity=.6},50);var n=document.createElement("div");n.className="icon ic3",ref.formContainer.appendChild(n),setTimeout(function(){n.style.opacity=.6},50);var o=document.createElement("div");o.className="icon ic4",ref.formContainer.appendChild(o),setTimeout(function(){o.style.opacity=.6},50);var r=document.createElement("div");r.className="fel",ref.footer.insertBefore(r,ref.footer.children[ref.footer.children.length-1]),r.appendChild(document.createTextNode("Drawings & images by the amazing "));var a=document.createElement("b");a.textContent="Dorottya Kiss",r.appendChild(a),r.appendChild(document.createElement("br")),r.appendChild(document.createTextNode("Content & footer icons by the talented "));var l=document.createElement("a");l.textContent="Lizzy Gregory",l.href="https://thenounproject.com/lizzy.gregory/",l.target="_blank",r.appendChild(l),r.appendChild(document.createTextNode(" and "));var i=document.createElement("a");i.textContent="Polina Flegontovna",i.href="https://thenounproject.com/flegontovna/",i.target="_blank",r.appendChild(i);var s=document.createElement("div");s.className="fel",s.style.fontSize="70%",ref.footer.insertBefore(s,ref.footer.children[ref.footer.children.length-1]),s.appendChild(document.createTextNode("(As a tribute to fellow Hungarian participant Eszter Kovacs and in case you're interested where our project got its name from, check out this "));var c=document.createElement("a");c.textContent="Futurama Clip",c.href="https://www.youtube.com/watch?v=6cjx4gJFME0",c.target="_blank",s.appendChild(c),s.appendChild(document.createTextNode(".)"));var d=document.createElement("div");d.className="wtree",ref.solutionContainer.insertBefore(d,ref.solutionContainer.children[0]),setTimeout(function(){d.style.opacity=.2},50)}function resultsAnimation(){var e=document.getElementById("ab"),t=e.children[0];t.className+=" bw-re",t.children[1].className+=" ib-re";var n=document.createElement("div");n.className="a fb",t.insertBefore(n,t.children[1]);var o=document.createElement("div");o.className="a h",t.appendChild(o),ref.water.className+=" w-re";var r=ref.waterBackground.children[0];r.style.opacity=0,setTimeout(function(){ref.waterBackground.removeChild(r)},at(1e3)),setTimeout(function(){var t=e.children[e.children.length-1];t.style.opacity=0,setTimeout(function(){e.removeChild(t)},at(1e3))},at(500))}function hideParagraphs(e){ref.water.style.height=ref.water.offsetHeight+"px",setTimeout(function(){ref.water.className+=" w-mp",ref.water.style.height="440px",setTimeout(function(){ref.water.style.height="",e()},at(1200))},10),ref.paragraphContainer.className+=" rem",setTimeout(function(){ref.water.removeChild(ref.paragraphContainer)},at(800))}function showResults(e){if(!onResults){onResults=!0;var t=!1,n=!1,o=!1,r=!1,a=null,l=null,i=function(){if(t&&n&&o&&!r){r=!0;var e=!1,i=function(){e||(e=!0,setTimeout(function(){window.scrollTo(0,0)},200),document.body.removeChild(ref.solutionContainer),ref.formContainer.className+=" fc-lp",ref.footer.className="ft-rc",hideParagraphs(function(){showMessages(l),showCharts(a,function(){resultsAnimation()})}))};smoothScrollTo(0,i),setTimeout(function(){i()},3e3)}};loadChartsAPI(function(){t=!0,i()},function(){errors.noCharts=!0,t=!0,i()}),loadStatistics(function(e){a=e,n=!0,i()}),animateFormLoading(400,function(){o=!0,i()}),loadMessages(function(e){r?showMessages(e):l=e})}}function animateFormLoading(e,t){var n=document.getElementById("f"),o=n.elements.s;o.value="",o.style.width=o.offsetHeight+"px",o.style.borderRadius="50%";for(var r=0;r<n.elements.length;r++)n.elements[r].disabled=!0;setTimeout(function(){o.className+=" fr-anim";var r=document.createElement("span");r.className="fl",r.textContent="Loading...",n.insertBefore(r,document.getElementById("err")),setTimeout(function(){r.style.opacity=1,setTimeout(function(){r.className+=" fl-anim",setTimeout(function(){t()},e)},at(150))},at(10))},at(155))}function showCharts(e,t){for(var n=0;n<ref.formContainer.children.length;n++)ref.formContainer.children[n].style.opacity=0;setTimeout(function(){if(ref.formContainer.children[0].textContent=errors.noCharts?"Could Not Load Charts API :(":errors.noStatistics?"Could Not Load Statistics :(":user.name?"Thank You, "+user.name:"We Are Making A Change",errors.noStatistics||errors.noCharts)return ref.formContainer.children[0].style.opacity=1,ref.formContainer.removeChild(ref.formContainer.children[1]),ref.formContainer.removeChild(ref.formContainer.children[1]),void(t&&t(null,!0));ref.formContainer.children[1].innerHTML="Our supporters are <b>all around the world</b>. They have all been making efforts. Global warming has <b>no borders and no walls</b> - if we want to stand against this common enemy, we need to stand united!",ref.formContainer.removeChild(ref.formContainer.children[2]),setTimeout(function(){for(var e=0;e<ref.formContainer.children.length;e++)ref.formContainer.children[e].style.opacity=1},250);var n=document.createElement("div");n.id="cw",n.style.opacity=0,ref.formContainer.appendChild(n),window.innerWidth>1279?n.style.height="720px":window.innerWidth>719?n.style.height="640px":n.style.height="480px",drawCharts(n,e,{backgroundColor:"none",colors:["#97d7a3","#18c238"]},function(){n.style.opacity=1,t&&t()})},at(300))}function drawCharts(e,t,n,o){function r(){t.splice(0,0,["Country","Supporters"]),t=google.visualization.arrayToDataTable(t);var r=new google.visualization.GeoChart(e);google.visualization.events.addListener(r,"ready",o),r.draw(t,n),document.getElementById("cw").style.opacity=0}google.charts.load("upcoming",{packages:["geochart"]}),google.charts.setOnLoadCallback(r)}function loadStatistics(e){load("s/l.php?statistics",function(t){for(var n=t.split(";"),o=[],r=0;r<n.length;r+=2)o.push([n[r],1*n[r+1]]);e(o)},null,function(){errors.noStatistics=!0,e()})}function showMessages(e){if(e){var t=document.getElementById("mw");if(t||(t=drawMessageContainer()),t){t.innerHTML="";for(var n=0;n<e.length;n++){var o=document.createElement("div");t.appendChild(o);var r=document.createElement("h3");o.appendChild(r);var a=document.createElement("span");r.appendChild(a);var l=document.createTextNode(e[n].name.trim());r.appendChild(l);var i=document.createElement("h4");i.textContent=e[n].country?e[n].country.trim():"-",o.appendChild(i);var s=document.createElement("h5");s.textContent="„"+e[n].message.trim()+"”",o.appendChild(s)}}}}function drawMessageContainer(){var e=document.createElement("div");e.id="mc",document.body.insertBefore(e,document.getElementById("ft"));var t=document.createElement("h1");if(t.textContent=errors.noMessages?"Could Not Load Messages :(":"Your Opinion Matters",e.appendChild(t),errors.noMessages)return null;var n=document.createElement("div");n.id="mw",e.appendChild(n);var o=document.createElement("a");return o.id="bb",o.href="./",o.textContent="Back To Index",e.appendChild(o),n}function loadMessages(e){load("s/l.php?messages",function(t){for(var n=t.split(";"),o=[],r=0;r<n.length&&""!=n[r];r+=3)o.push({name:n[r],country:n[r+1],message:n[r+2]});e(o)},null,function(){errors.noMessages=!0,e(null)})}function loadChartsAPI(e,t){var n=!1,o=!1,r=!1,a=function(){n&&o&&(r=!0,e&&e())};loadScript("https://www.gstatic.com/charts/loader.js?key="+apiKey,function(e,o){return o&&!r?(r=!0,void(t&&t())):(n=!0,void a())}),loadScript("//maps.googleapis.com/maps/api/js?key="+apiKey,function(e,n){return n&&!r?(r=!0,void(t&&t())):(o=!0,void a())}),setTimeout(function(){r||(e=null,t&&t())},5e3)}function ajaxify(){var e=document.getElementById("f");e.onsubmit=function(e){e&&e.preventDefault&&e.preventDefault(),submitForm()},errorTypes={noname:"Please submit a name!",namelong:"Please submit a shorter name! (Max 32 chars)",noemail:"Please submit an e-mail address!",email:"Please submit a valid e-mail address!",emaillong:"Please submit a shorter e-mail address! (Max 64 chars)",country:"Please submit a valid country!",emailexists:"This e-mail address is already in use!",server:"You managed to bug the server, congrats!",badwordsname:"Please don't use nasty words in your name!",badwordsmessage:"Please don't use nasty words in your message!"};var t=document.getElementById("r");t.href="",t.onclick=function(e){e.preventDefault(),user.name=null,showResults(!1)};var n=document.getElementById("t");n.href="",n.onclick=function(e){e.preventDefault(),smoothScrollTo(0)};var o=document.getElementById("sl");o.href="",o.onclick=function(e){e.preventDefault(),smoothScrollTo(ref.formContainer.offsetTop)}}function submitForm(){var e=document.getElementById("f"),t=document.getElementById("err");t.innerHTML="";var n=e.elements.n.value,o=e.elements.e.value,r=e.elements.c.value,a=e.elements.m.value,l="a=1&n="+n+"&e="+o;r&&(l+="&c="+r),a&&(l+="&m="+a);var i=o.lastIndexOf("@"),s=o.lastIndexOf(".");if(-1==i||-1==s||i>s)return displayFormErrors(["email"]),e.elements.e.focus(),void e.elements.e.select();var c="POST",d={};d["Content-type"]="application/x-www-form-urlencoded",e.elements.s.disabled=!0,e.elements.m.focus(),load("s/s.php",function(e){user.name=n?n.trim():n,showResults(!0)},{method:c,data:l,headers:d},function(t){e.elements.s.disabled=!1,t=400==this.status&&t?t.split(","):["server"],displayFormErrors(t)})}function displayFormErrors(e){var t=document.getElementById("err");t.innerHTML="",t.style.opacity=0;for(var n=0;n<e.length;n++){var o=document.createElement("h4");o.textContent=errorTypes[e[n]],t.appendChild(o)}setTimeout(function(){t.style.opacity=1},at(25))}function enhanceCountryOptions(){loadCountries(function(e){loadCss("select.css");var t=document.getElementById("f"),n=document.getElementById("c"),o=document.createElement("select");o.id="c",o.name="c",t.insertBefore(o,n);for(var r=0;r<e.length;r++){var a=document.createElement("option");a.value=e[r],a.text=e[r],o.appendChild(a)}t.removeChild(n)})}function loadCountries(e){load("s/countries.txt",function(t){e.call(this,t.split("\n"))})}function extendStyles(e){extended||(extended=!0,loadCss("e.css",function(){e&&e()}))}function getCommonReferences(){ref.backToTop=document.body.children[0],ref.animationContainer=document.body.children[1],ref.solutionContainer=document.body.children[2],ref.formContainer=document.body.children[3],ref.footer=document.body.children[4],ref.water=ref.animationContainer.children[1].children[0],ref.waterBackground=ref.water.children[0],ref.paragraphContainer=ref.water.children[2]}function at(e){return animatable?e:0}function smoothScrollTo(e,t){if(e!=getScrollY()){clearInterval(scrollInterval);var n=20,o=10;scrollComplete=t,scrollDirection=e>getScrollY()?1:-1,lastScrollY=getScrollY(),scrollInterval=setInterval(function(){1==scrollDirection?(getScrollY()+window.innerHeight>=document.body.clientHeight?clearInterval(scrollInterval):window.scrollTo(0,getScrollY()+n),n>1&&e-getScrollY()<205&&n--,getScrollY()>=e&&(window.scrollTo(0,e),clearInterval(scrollInterval),scrollInterval=null,scrollComplete&&scrollComplete.call(this))):(0==getScrollY()?clearInterval(scrollInterval):window.scrollTo(0,getScrollY()-n),n>1&&getScrollY()-e<205&&n--,getScrollY()<=e&&(window.scrollTo(0,e),clearInterval(scrollInterval),scrollInterval=null,scrollComplete&&scrollComplete.call(this)))},o)}}function getScrollY(){return null!=scrollYSupport?scrollYSupport?window.scrollY:document.documentElement.scrollTop:void(scrollYSupport="undefined"!=typeof window.scrollY?!0:!1)}function isAnimatable(){if(domPrefixes="Webkit Moz O ms Khtml".split(" "),elm=document.createElement("div"),void 0!==elm.style.animationName)return!0;for(var e=0;e<domPrefixes.length;e++)if(void 0!==elm.style[domPrefixes[e]+"AnimationName"])return!0;return!1}function loadCss(e,t){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e+(nocache?(-1==e.indexOf("?")?"?":"&")+Date.now():""),n.media="gohungary";var o=!1;n.onload=function(){this.media="all",!o&&t&&t(),o=!0},document.getElementsByTagName("head")[0].appendChild(n),setTimeout(function(){o||t(null,!0)},2500)}function loadScript(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e+(nocache?(-1==e.indexOf("?")?"?":"&")+Date.now():""),n.async=!0,n.defer=!0;var o=!1;n.onload=function(){!o&&t&&t(),o=!0},document.getElementsByTagName("head")[0].appendChild(n),setTimeout(function(){o||t(null,!0)},2500)}function load(e,t,n,o){n=n?n:{},n.method=n.method?n.method:"GET",n.data=n.data?n.data:void 0;var r;if(r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r.onreadystatechange=function(){4==this.readyState&&(200==this.status?t.call(this,this.responseText):o&&o.call(this,this.responseText))},nocache&&(e+=(-1==e.indexOf("?")?"?":"&")+Date.now()),r.open(n.method,e,!0),n.headers)for(var a in n.headers)r.setRequestHeader(a,n.headers[a]);r.send(n.data)}var initialized=!1,extended=!1,nocache=!1,errorTypes,animatable=!1,onResults=!1,errors={},ref={},user={},apiKey="AIzaSyDUiv-4MRBa_S6Wsj0AuzBwUNWSm0blNQI",scrollInterval=null,scrollDirection,scrollComplete,scrollYSupport=null,lastScrollY=getScrollY();window.addEventListener("scroll",function(e){if(null!=scrollInterval){var t=getScrollY();t>lastScrollY?-1==scrollDirection&&(clearInterval(scrollInterval),scrollInterval=null,scrollComplete&&scrollComplete.call(this)):lastScrollY>t&&1==scrollDirection&&(clearInterval(scrollInterval),scrollInterval=null,scrollComplete&&scrollComplete.call(this)),lastScrollY=getScrollY()}});var initTriesLeft=5,initInterval=setInterval(function(){initTriesLeft--,initialized||!initTriesLeft?clearInterval(initInterval):window.init&&init()},250);
